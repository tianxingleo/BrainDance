在本次对话中，我们对 3DGS 数据处理流程进行了深度的调试与算法优化，主要经历了以下四个阶段的演进：

1. **解决系统级并发问题 (WSL I/O Latency)**

   - **问题**：FFmpeg 刚写完文件，Python 读取到的数量为 0 或不全，导致后续逻辑误判。
   - **思考**：这是 WSL (Windows Subsystem for Linux) 跨文件系统操作的典型延迟特性。
   - **对策**：引入“强制同步等待 ([time.sleep](vscode-file://vscode-app/c:/Users/ltx/AppData/Local/Programs/Microsoft VS Code/resources/app/out/vs/code/electron-browser/workbench/workbench.html))”和“Glob 读取重试机制”，确保文件系统索引更新后再进行处理。

2. **解决数据一致性问题 (Data Consistency)**

   - **问题**：训练时报 `FileNotFoundError`。
   - **思考**：COLMAP 生成索引后，脚本又删除了部分图片（为了限制数量），导致索引指向了不存在的文件。
   - **对策**：调整逻辑顺序，确保进入 COLMAP 流程后的图片集合不再发生任何增删变动。

3. **引入质量熔断机制 (Quality Control)**

   - **问题**：COLMAP 算出来的稀疏点云质量极差（不收敛或匹配率低），但流程依然继续，浪费算力。

   - **思考**：需要在 [ns-process-data](vscode-file://vscode-app/c:/Users/ltx/AppData/Local/Programs/Microsoft VS Code/resources/app/out/vs/code/electron-browser/workbench/workbench.html) 阶段进行“截断”。

   - 对策

     ：

     - 捕获 COLMAP 日志，正则匹配 `Termination : No convergence` 和 `COLMAP only found poses for X%`。
     - 提取 `Final cost` 以量化误差。
     - 设定阈值（匹配率 < 35%），触发自动终止并清理 Linux 临时工作区。

4. **图像清洗算法的终极进化 (Image Filtering Strategy)**

   - **V1 (原始)**：基于拉普拉斯算子评分，剔除最差的 15%。

   - **V2 (用户提议)**：如果数量超过上限，只保留分数最高的 Top N。

   - **V3 (反思)**：V2 存在致命缺陷。如果物体背面整体光线暗或模糊，V2 会把背面的图全删了，导致**视角缺失 (Perspective Loss)**。

   - V4 (最终混合策略)

     ：

     - **Step 1 质检**：无条件剔除最差的 15%（干掉绝对废片）。
     - **Step 2 采样**：如果剩余数量仍超标，采用**均匀采样 (Uniform Sampling)**。
     - **优势**：既保证了单张图片的最低画质，又通过时间轴均匀分布保证了 360 度视角的完整覆盖。